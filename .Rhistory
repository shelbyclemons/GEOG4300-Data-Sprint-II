knitr::opts_chunk$set(echo = TRUE)
install.packages("tidytuesdayR")
library("tidytuesdayR")
library("sf")
library("tidyverse")
library("dplyr")
library("tmap")
library("rnaturalearth")
tuesdata <- tidytuesdayR::tt_load('2025-08-19')
scottish_munros <- tuesdata$scottish_munros
munro_map <- scottish_munros %>%
filter(!is.na(xcoord) & !is.na(ycoord)) %>%
st_as_sf(coords=c("xcoord","ycoord"), crs = 27700) %>%
st_transform(4326)
projection <- scottish_munros %>%
filter(!is.na(xcoord) & !is.na(ycoord)) %>%
st_as_sf(coords=c("xcoord","ycoord"), crs = 27700) %>%
st_transform(4326) %>%
st_coordinates()
munro_map_XY <- munro_map %>%
cbind(projection)
scotland <- ne_countries(geounit = "scotland", type = "map_units", scale="large")
install.packages("rnaturalearth")
scotland <- ne_countries(geounit = "scotland", type = "map_units", scale="large")
install.packages("tidytuesdayR")
install.packages("rnaturalearth")
install.packages("rnaturalearthdata")
install.packages("rnaturalearthhires")
library("rnaturalearthdata")
library("rnaturalearthhires")
scotland <- ne_countries(geounit = "scotland", type = "map_units", scale="medium")
sf_use_s2(FALSE)
install.packages("sf")
library("sf")
sf_use_s2(FALSE)
library(rnaturalearth)
rnaturalearth::ne_countries(
geounit = "scotland",
type = "map_units",
scale = "medium",
returnclass = "sf"
)
scotland <- ne_countries(geounit = "scotland", type = "map_units", scale="medium")
water <- ne_download(scale=10, type="lakes", category="physical")
river <- ne_download(scale=10, type="rivers_lake_centerlines", category="physical")
waterscotland <- st_filter(water,scotland)
riverscotland <- st_filter(river, scotland)
ggplot(scotland) +
geom_sf() +
geom_sf(data=waterscotland, fill="blue") +
geom_sf(data=riverscotland, color="blue") +
geom_point(data=munro_map_XY %>%
filter(!is.na('X2021')),
aes(x=X,y=Y,color='X2021')) +
coord_sf(xlim=c(-10,0))
library("ggplot2")
ggplot(scotland) +
geom_sf() +
geom_sf(data=waterscotland, fill="blue") +
geom_sf(data=riverscotland, color="blue") +
geom_point(data=munro_map_XY %>%
filter(!is.na('X2021')),
aes(x=X,y=Y,color='X2021')) +
coord_sf(xlim=c(-10,0))
munro_points <- munro_map_XY %>%
sf::st_drop_geometry() %>%
dplyr::filter(!is.na(X2021))
ggplot() +
geom_sf(data = scotland) +
geom_sf(data = waterscotland, fill = "blue") +
geom_sf(data = riverscotland, color = "blue") +
geom_point(
data = munro_points,
aes(x = X, y = Y, color = X2021)
) +
coord_sf(xlim = c(-10, 0))
munros_2021 <- scottish_munros %>%
filter(!is.na(xcoord), !is.na(ycoord), `2021` == "Munro") %>%
st_as_sf(coords = c("xcoord", "ycoord"), crs = 27700)
munro_points <- munro_map_XY %>%
sf::st_drop_geometry() %>%
dplyr::filter(!is.na(`2021`))
munro_points <- scottish_munros %>%
filter(!is.na(xcoord), !is.na(ycoord)) %>%
mutate(X = xcoord, Y = ycoord) %>%
filter(!is.na(`2021`))
munro_points <- munro_map_XY %>%
sf::st_drop_geometry() %>%
dplyr::filter(!is.na(X2021))
ggplot() +
geom_sf(data = scotland) +
geom_sf(data = waterscotland, fill = "blue") +
geom_sf(data = riverscotland, color = "blue") +
geom_point(
data = munro_points,
aes(x = X, y = Y, color = X2021)
) +
coord_sf(xlim = c(-10, 0))
munros_2021 <- scottish_munros %>%
filter(!is.na(xcoord), !is.na(ycoord), `2021` == "Munro") %>%
st_as_sf(coords = c("xcoord", "ycoord"), crs = 27700)
View(munro_points)
View(munro_map_XY)
names(scottish_munros)
names(munro_map)
View(scottish_munros)
munros_2021 <- munro_map %>%
filter(`2021` == "Munro") %>%
st_transform(27700)
munros_2021 <- munro_map %>%
filter(`2021` == "Munro") %>%
st_transform(27700)
munros_2021_df <- scottish_munros %>%
filter(!is.na(xcoord), !is.na(ycoord), `2021` == "Munro"
coords <- munros_2021_df %>%
munros_2021_df <- scottish_munros %>%
filter(!is.na(xcoord), !is.na(ycoord), `2021` == "Munro")
munros_2021_df <- scottish_munros[
scottish_munros$`2021` == "Munro" &
!is.na(scottish_munros$xcoord) &
!is.na(scottish_munros$ycoord),
]
coords <- munros_2021_df %>%
select(xcoord, ycoord) %>%
as.matrix()
coords <- as.matrix(
munros_2021_df[, c("xcoord", "ycoord")]
)
dist_obj <- dist(coords)
dist_mat <- as.matrix(dist_obj)
diag(dist_mat) <- NA
nearest_dist_m <- apply(dist_mat, 1, min, na.rm = TRUE)
munros_2021_df$nearest_munro_m <- nearest_dist_m
munros_2021_df$nearest_munro_km <- nearest_dist_m / 1000
most_remote <- munros_2021_df[which.max(munros_2021_df$nearest_munro_km), ]
most_remote
munros_2021_df <- scottish_munros[
!is.na(scottish_munros$`2021`) &
!grepl("Top", scottish_munros$`2021`) &
!is.na(scottish_munros$xcoord) &
!is.na(scottish_munros$ycoord),
]
coords <- as.matrix(munros_2021_df[, c("xcoord", "ycoord")])
dist_obj <- dist(coords)
dist_mat <- as.matrix(dist_obj)
diag(dist_mat) <- NA
nearest_dist_m <- apply(dist_mat, 1, min, na.rm = TRUE)
munros_2021_df$nearest_munro_m <- nearest_dist_m
munros_2021_df$nearest_munro_km <- nearest_dist_m / 1000
most_remote <- munros_2021_df[which.max(munros_2021_df$nearest_munro_km), ]
most_remote
View(most_remote)
